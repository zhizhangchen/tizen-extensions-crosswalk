<html>
	<body>
	hello
	<script>
        document.write("From JavaScript");
        var event_init = {
          startDate: new tizen.TZDate(2011, 3, 30, 10, 0),
          duration: new tizen.TimeDuration(1, "HOURS")
        },
        calendar = tizen.calendar.getDefaultCalendar("EVENT"),
        ev = new tizen.CalendarEvent(event_init);

        console.log("#################################ev before call:" + JSON.stringify(ev));
        calendar.add(ev);
        console.log("ev after call:" + JSON.stringify(ev));
        console.assert(ev.id !== null, "id shouldn't be null");
        console.assert("geolocation" in ev,"The geolocation attribute should exist");
        function testFind() {
          function onSuccess(results) {
            console.log(results.length + " call history item(s) found!");
            for (var i=0; i<results.length; i++) {
              console.log(i + ". " + results[i].toString()); // process the CallHistoryEntry
            }
          }

          // Defines error callback
          function onError(error) {
            console.log("Query failed" + error.name);
          }

          // Defines filter: list CS calls, most recent first
          var filter = new tizen.AttributeFilter("type", "EXACTLY", "TEL");

          // Defines sort mode: descending on call start time.
          var sortMode = new tizen.SortMode("startTime", "DESC");

          // Makes the query and wire up the callbacks
          tizen.callhistory.find(onSuccess,
          onError,
          filter,
          sortMode);

          var numberFilter = new tizen.AttributeFilter(
          "remoteParties.remoteParty",
          "EXACTLY",
          "123456789");

          // Creates a composite filter for time constraints
          var y2009Filter = new tizen.AttributeRangeFilter(
          "startTime",
          new Date(2009, 0, 1),
          new Date(2010, 0, 1));

          var y2011Filter = new tizen.AttributeRangeFilter(
          "startTime",
          new Date(2011, 0, 1),
          new Date(2012, 0, 1));

          var dateFilter = new tizen.CompositeFilter("UNION", [y2009Filter, y2011Filter]);

          // Creates a filter to find all video calls (including cellular, skype, etc)
          // The filter matches exactly any features from the "features" array
          var tfilter = new tizen.AttributeFilter("features", "EXACTLY", "VIDEOCALL");

          // Creates composite filter
          var ifilter = new tizen.CompositeFilter("INTERSECTION",
          [numberFilter, dateFilter, tfilter]);

          // Makes the query and wire up the callbacks; reuse sortMode
          tizen.callhistory.find(onSuccess,
          onError,
          ifilter,
          sortMode);

        }
        var onListenerCB = {
            onadded: function(newItems) {
                console.log("New Item added");
                for (var i in newItems) {
                    console.log("Item " + i + " startTime: " + newItems[i].startTime);
                }
            },
            onchanged: function(changedItems) {
                console.log("Items changed");
                for (var i in changedItems) {
                    console.log("Item " + i + " direction: " + changedItems[i].direction);
                }
            },
            onremoved: function(removedItems) {
                console.log("Items removed");
                for(var i in removedItems)  {
                    console.log("Item " + i + " : " + removedItems[i]);
                }
            }
        };

        try {
            // Registers a call history callback
            //var handle = tizen.callhistory.addChangeListener(onListenerCB);
            var handle = tizen.callhistory.addChangeListener({onadded:true});
            console.log("Handle: " + handle);
            // Unregisters a previously registered listener
            tizen.callhistory.removeChangeListener(handle);
        } catch (error) {
            console.log("Exception - code: " + error.name + " message: " + error.message);
        }
        //testFind()

        tizen.callhistory.find(function (entries) {
            console.log("call history:" + JSON.stringify(entries));
            console.log("removing...");
            try{
            tizen.callhistory.remove(entries[0]);
            tizen.callhistory.removeAll(function () {
              console.log("removeAll succeeded!");
              }, function (error) {
              console.log("removeAll failed:" + error);
            });
            tizen.callhistory.removeBatch(entries, function () {
              console.log("removeBatch succeeded!");
              }, function (error) {
              console.log("removeBatch failed:" + JSON.stringify(error));
            });
            }catch (e) {
              console.log("Exception:" +e);
            }

        }, NaN);

	</script>
	</body>
</html>
